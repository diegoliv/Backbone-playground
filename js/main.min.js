var AppView=Backbone.View.extend({el:$("#container"),template:_.template("<h4>Hello <%= who %>, have a nice <%= what %>!<h4>"),initialize:function(){this.render()},render:function(){this.$el.html(this.template({who:"world",what:"day"}))}}),appView=new AppView,app={};app.Todo=Backbone.Model.extend({defaults:{title:"",completed:!1}}),app.TodoList=Backbone.Collection.extend({model:app.Todo,localStorage:new Store("backbone-todo")}),app.todoList=new app.TodoList,app.TodoView=Backbone.View.extend({tagName:"li",template:_.template($("#item-template").html()),render:function(){return this.$el.html(this.template(this.model.toJSON())),this}}),app.AppView=Backbone.View.extend({el:"#todoapp",initialize:function(){this.input=this.$("#new-todo"),app.todoList.on("add",this.addAll,this),app.todoList.on("reset",this.addAll,this),app.todoList.fetch()},events:{"keypress #new-todo":"createTodoOnEnter"},createTodoOnEnter:function(e){13===e.which&&this.input.val().trim()&&(app.todoList.create(this.newAttributes()),this.input.val(""))},addOne:function(e){var t=new app.TodoView({model:e});$("#todo-list").append(t.render().el)},addAll:function(){this.$("#todo-list").html(""),app.todoList.each(this.addOne,this)},newAttributes:function(){return{title:this.input.val().trim(),completed:!1}}}),app.appView=new app.AppView;